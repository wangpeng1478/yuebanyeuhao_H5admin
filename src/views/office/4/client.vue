
<style lang="less">
 .client{
  padding-top:40px;
  .demotableinforow{
    .paddse{
      background:#c1e6ff;
    }
  }
   .sere{
    .ivu-form-item{
      // margin-bottom: 8px;
    }
  }
  .selectsNmae{
    .ivu-select-not-found{
      display:none
    }
   }
  .input-group {
    position: relative;
    display: table;
    border-collapse: separate;
    input{
        box-sizing: border-box;
        border: solid 1px #ddd;
        font-size: 12px;
        height: 31px;
        line-height: 1.42857;
        padding: 4px;
        border-right: none;
        text-align: center;
        width:35%;
        color: #495060;
    }
    input:focus{
      border-color: #57a3f3;
      outline: 0;
      box-shadow: 0 0 0 2px rgba(45,140,240,.2);
    }
    input:first-child{
      border-radius: 3px 0 0 3px;
    }
    span{
      display: inline-block;
      width: 30%;
      height: 31px;
      line-height: 31px;
      text-align: center;
      background-color: #eee;
      border: 1px solid #ccc;
      font-size: 12px;
      vertical-align: top;
      border-radius: 0 3px 3px 0;
    }
  }
  .ivu-card{
    margin-bottom:15px;
  }
  .padd10{
    .ivu-card-body{
      padding:7px;
    }
  }
  .titims{
    .ivu-card-body{
      padding:5px;
    }
    .spanrihe{
      font-size:12px;
      float:right;
      line-height: 31px;
    }
  }
  .lstable{
    .tableUl{
      .ls{margin-bottom:10px;}
      .li{
        background:#e6f5ff;
        padding: 10px;
        border:1px solid #c1e7ff;
        .le{
          float:left;
          cursor: pointer;
          &:hover{
            opacity: 0.7;
          }
        }
        .rig{
          float:right;
          a{
            margin: 0 10px;
          }
        }
      }
    }
  }
  .pages{
     float: right;
     margin: 15px 5px 5px 0;
   }
   .ovhidese{
     overflow:auto;
     .tablese{
       min-width: 1300px;
     }
   }
   .Checkboxnava{
     padding: 5px;
     border: 1px solid #EEE;
     border-radius: 3px;
   }
   .Checkboxnavared{
    border: 1px solid #2d8cf0;
    color: #2d8cf0;
   }


   .table-border {
    border-top: 1px solid #ddd;
   }
   table {
    width: 100%;
    empty-cells: show;
    background-color: transparent;
    border-collapse: collapse;
    border-spacing: 0;
}
.thead {
    background: #f0f0f0;
    border-left: 1px solid #ddd;
    border-right: 1px solid #ddd;
}
.text-c {
    text-align: center;
}
.table .text-c th, .table .text-c td {
    text-align: center;
}
.table-border th, .table-border td {
    border-bottom: 1px solid #ddd;
}
.table th, .table td {
    padding: 8px;
    line-height: 20px;
    word-break: break-all;
}
.table th {
    font-weight: bold;
}

.lr_11 td, .fenge td {
    border-bottom: 1px solid #c1e7ff !important;
}
.table-border th, .table-border td {
    border-bottom: 1px solid #ddd;
}
.table td {
    text-align: left;
}
.table th, .table td {
    padding: 8px;
    line-height: 20px;
    word-break: break-all;
}
.lr_11 {
    border-left: 1px solid #c1e7ff !important;
    border-right: 1px solid #c1e7ff !important;
}
.l, .f-l {
    float: left!important;
    _display: inline;
}
.strong_ddd {
    font-size: 13px;
    color: #4b4b4b;
}
.span_ddd {
    color: #7b7b7b;
    margin-right: 10px;
}
.tr_bg {
    background: #e6f5ff;
}
.lr_11 {
    border-left: 1px solid #c1e7ff !important;
    border-right: 1px solid #c1e7ff !important;
 }
 .iosstar{
  font-size:20px;
  color:#05b705;
  margin:0 5px;
 }
 .paddse td{
    padding: 15px 0;
 }
   .Selectt{
      max-width: 100px;
     .ivu-select-selection{
       border:none;
       background: #f0f0f0;
     }
     .ivu-select-placeholder{
      color:#495060;
      line-height: 25px !important;
     }
   }
   .dspodasd{
     display:inline-block;
     margin-left: 10px;
     vertical-align: top;
   }
 }


 // ********************************

.client{
  .selectUI{
    width: 100%;
    height: 32px;
    line-height: 1.5;
    padding: 4px 7px;
    font-size: 12px;
    border: 1px solid #dddee1;
    border-radius: 4px;
    color: #495060;
    background-color: #fff;
  }
  .sou1{
    background:#fff;
    padding: 4px;
  }
  .sou2{
    background:#fff;
    padding: 4px;
    box-shadow: 1px 2px 1px 0px rgba(0, 0, 0, 0.13);
    .soup{
      text-align:center;
      padding: 5px 0;
      .ivu-icon{
        padding-left: 5px;
      }
    }
    .on{
      color:#2b85e4;
    }
  }
 .navfix{
    position:fixed;
    top:40px;
    left:0;
    width:100%;
    z-index: 10;
    .cons{
      background:#fff;
      height:100vh;
      overflow: hidden;
      .botonbur{
        position:fixed;
        bottom:0;
        left:0;
        width:100%;
        button{
          width:50%;
        }
        .ivu-btn-ghost{background:#fff}
      }
      .p1{
        text-align: center;
        padding: 10px 0;
        border-bottom: 1px solid #eee;
        border-right: 1px solid #eee;    
        &:first-child{
         border-top: 1px solid #eee;
        }
      }
      .p2{
        text-align: center;
        padding: 10px 0;
        border-bottom: 1px solid #eee;   
        &:first-child{
         border-top: 1px solid #eee;
        }
      }
      .on{
        background: #f7f7f7;
      }
      .on2{
        color:#2b85e4;
      }
    }
    .ovhide{
      height:80vh;
      overflow:auto;
      padding-bottom: 50px;
    }
 }
}


.client{
  .classtable{
    border-bottom:1px solid #eee;
    padding:6px;
    margin:0 0 8px 0;
    background: #fff;
   .hd{
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
   }
    .ivu-tag {
    padding: 0 2px;
    font-size: 11px;
    height: 20px;
    line-height: 20px;
    margin: 0;
    zoom: 0.8;
    vertical-align: text-top;
    background: #fff !important;
  }
   .tcbtiele{
     background:#e6f5ff;
     border:1px solid #c1e7ff;
     padding: 5px;
     line-height: 1.7;
   }
   .tcbbody{
     padding:5px;
     border:1px solid #c1e7ff;
     border-top:none;
     .tcbbodyh3{
       font-size: 13px;
       font-weight: 300;
     }
     .ivu-col{
       margin-bottom: 3px;
     }
     .hr{
       border-bottom: 1px dashed #eee;
       margin: 5px 0;
     }
   }
  }
  .cardlistno{
    background: #fff;
    margin: 5px 0;
    padding: 40px;
    text-align: center;
    i{
      font-size: 2em;
      margin-bottom: 10px;
    }

  }

}

.modalact{
    .ivu-modal-body{
      padding:10px 0;
      text-align: center;
    }
    .ivu-checkbox-wrapper{
      margin-right:0;
    }
    .ivu-transfer-list-content-item,.ivu-transfer-list-header{
      text-align:left
    }
  }
</style>

<template>
   <div class="client cf" :class="{hide:ovhide}">
    <pre>{{datas}}</pre>
       <div>
       <Form :model="screens" :label-width="80">
         <div class="navfix">
           <Row class="sou2">
              <Col span="6"><p @click="navsr(0)" :class="{on:onst==0}" class="soup">排序<Icon type="arrow-down-b"></Icon></p></Col>
              <Col span="6"><p @click="navsr(1)" :class="{on:onst==1}" class="soup">跟进人<Icon type="arrow-down-b"></Icon></p></Col>
              <Col span="6"><p @click="navsr(2)" :class="{on:onst==2}" class="soup">客户状态<Icon type="arrow-down-b"></Icon></p></Col>
              <Col span="6"><p @click="navsr(3)" :class="{on:onst==3}" class="soup">筛选<Icon type="funnel"></Icon></Icon></p></Col>
           </Row>
           <Row v-if="onst==0" class="cons">
            <Col class="ovhide">
               <p class="p2" :class="{on:screens.sorting == 0}" @click="sorens(0)">跟进时间排序<Icon type="arrow-down-c"></Icon></p> <!-- 大小 -->
               <p class="p2" :class="{on:screens.sorting == 1}" @click="sorens(1)">跟进时间排序<Icon type="arrow-up-c"></Icon></p> 
               <p class="p2" :class="{on:screens.sorting == 2}" @click="sorens(2)">录入时间排序<Icon type="arrow-down-c"></Icon></p> <!-- 大小 -->
               <p class="p2" :class="{on:screens.sorting == 3}" @click="sorens(3)">录入时间排序<Icon type="arrow-up-c"></Icon></p>
            </Col>
          </Row>
          <Row class="cons" v-if="onst==1">
          <Col span="8" class="ovhide">
            <p class="p1" :class="{on:yeson==index}" v-for="(item,index) in followupdata" :key="item.value" @click="clickyes(index,item.value)">{{item.value}}</p>
          </Col>
          <Col span="16" class="ovhide" style="background: #f7f7f7;">
            <p class="p2" :class="{on2:yeson2==index}" v-for="(item,index) in childrenre" :key="item.value" @click="clickyes2(index,item.value)">
              {{item.value}}
            </p>
          </Col>
          <ButtonGroup class="botonbur">
            <Button type="ghost" icon="reply" @click="conno">重置</Button>
            <Button type="primary" icon="ios-search" @click="conyes">确认</Button>
          </ButtonGroup>
       </Row>

        <Row v-if="onst==2" class="cons">
          <Col class="ovhide">
                  <p class="p2" @click="strenc('全部')" :class="{on:screens.status == '全部'}" >全部</p>
                  <p class="p2" @click="strenc('有效')" :class="{on:screens.status == '有效'}" >有效</p>
                  <p class="p2" @click="strenc('待确认')" :class="{on:screens.status == '待确认'}" >待确认</p>
                  <p class="p2" @click="strenc('已流失')" :class="{on:screens.status == '已流失'}" >已流失</p>
                  <p class="p2" @click="strenc('跳单')" :class="{on:screens.status == '跳单'}" >跳单</p>
                  <p class="p2" @click="strenc('我成交')" :class="{on:screens.status == '我成交'}" >我成交</p>
                  <p class="p2" @click="strenc('长期维护')" :class="{on:screens.status == '长期维护'}" >长期维护</p>
          </Col>
        </Row>

         <Row v-if="onst==3" class="cons" style="padding: 5px 10px 0 10px;border-top: 1px solid #eee;">
           <Col class="ovhide"> 
              <FormItem label="客户姓名">
                  <Input v-model="screens.name"></Input>
               </FormItem>
               <FormItem label="联系方式">
                  <Input v-model="screens.contact"></Input>
               </FormItem>
                <FormItem label="客户公司">
                  <Input v-model="screens.gname"></Input>
               </FormItem>
               <FormItem label="客户行业">
                   <select v-model="screens.tradex" class="selectUI">
                    <option value="IT|通信|电子|互联网">IT|通信|电子|互联网</option>
                    <option value="金融业">金融业</option>
                    <option value="房地产|建筑">房地产|建筑</option>
                    <option value="贸易|批发|零售|租赁业">贸易|批发|零售|租赁业</option>
                    <option value="生产|加工|制造">生产|加工|制造</option>
                    <option value="交通|运输|物流|仓储">交通|运输|物流|仓储</option>
                    <option value="服务业">服务业</option>
                    <option value="文化|传媒|娱乐|体育">文化|传媒|娱乐|体育</option>
                    <option value="文体教育|工艺美术">文体教育|工艺美术</option>
                    <option value="能源|矿产|环保">能源|矿产|环保</option>
                    <option value="商业服务">商业服务</option>
                    <option value="政府|非盈利机构">政府|非盈利机构</option>
                    <option value="农|林|牧|渔">农|林|牧|渔</option>
                    <option value="机械设备|医疗器械">机械设备|医疗器械</option>
                    <option value="其他">其他</option>
                  </select>
               </FormItem>
               <FormItem label="需求面积">
                  <div class="input-group">
                    <input v-model="screens.minaji.min" type="text" maxlength="8">
                    <input v-model="screens.minaji.max" type="text" maxlength="8">
                    <span>m²</span>
                  </div>
               </FormItem>
                <FormItem label="需求价格">
              <div class="input-group">
                 <input v-model="screens.minar.min" type="text" maxlength="8">
                 <input v-model="screens.minar.max" type="text" maxlength="8">
                <span>元</span>
              </div>
              </FormItem>
               <FormItem label="客户等级">
                    <RadioGroup v-model="screens.grade" type="button">
                        <Radio label="A">A级</Radio>
                        <Radio label="B">B级</Radio>
                        <Radio label="C">C级</Radio>
                    </RadioGroup>
              </FormItem>
                <FormItem label="原地址">
                   <Input v-model="screens.originalAddress"></Input>
              </FormItem>
               <FormItem label="ID">
                 <Input v-model="screens.id"></Input>
              </FormItem>
               <FormItem label="录入人">
                  <Cascader :data="followupdata" v-model="screens.luru"  change-on-select></Cascader>
              </FormItem>
               <FormItem label="客户介绍人">
                  <Input v-model="screens.jieshao"></Input>
              </FormItem>
               <FormItem label="来源">
                  <Cascader :data="Cascaderdata" v-model="screens.cascader"  change-on-select></Cascader>
              </FormItem>
           </Col>
            <ButtonGroup class="botonbur">
              <Button type="ghost" icon="reply" @click='reson'>重置</Button>
              <Button type="primary" icon="ios-search" @click='screenss'>确认</Button>
            </ButtonGroup>
          </Row>


         </div>
    </Form>
    </div>
    <!-- nav -->
     <Card class='titims'>
        <div class="cf">
         <Button class="lesr" @click.prevent="addLOUPan" type="primary" size="small" shape="circle" icon="ios-plus-outline">添加客户</Button>
         <Checkbox @on-change="soose" class="lesr Checkboxnava" :class='{Checkboxnavared:screens.single}' v-model="screens.single">我的合作客户</Checkbox>
         <p class="spanrihe">共有数据:<b>{{totals}}</b>条</p>
       </div>
    </Card>

    <!-- rrrrrrr -->
      <div class="div">
          <div v-for="(n, index) in datas" :key="index" class="classtable">
           <Row class="tcbtiele">
              <Col class="hd"><b>{{n.luru}}</b>在{{n.uptime2}}录入 最新跟进:{{n.uptime1}}</Col>
              <Col class="hd">
                <span v-if="n.cascader !== null">来源:{{n.cascader}}</span>
                <span>原地址:{{n.originalAddress}}</span>
              </Col>
              <Col style="text-align: right;padding-right: 10px;">
                <a @click.prevent="routerse1(n.id,index)" href="javascript:;">查看详情</a>
              </Col>
              
          </Row>

          <Row class="tcbbody">
            <Col>
              <Poptip placement="top" trigger="hover" :title="n.gname">
               <div>
                <b>{{n.gname}}</b>
                <span v-for="e in n.name"> {{e}}, </span>
              </div>
                <div class="api" slot="content">
                  <p v-for="f in n.name">{{f}}</p>
                </div>
            </Poptip>
            </Col>
            <Col>{{n.minaji}}m²  {{n.minar}}/m²*天</Col>
            <Col>
               <p v-for="(s, index) in n.intention" :key="s.length">
                  {{s.name}}
               </p>
            </Col>
            <Col>
              <Tag type="border" :color="n.status =='有效'?'red':'#666'">{{n.status}}</Tag>
               <b>{{n.grade}}</b>
              <Tag type="border" color="#ff5722">{{n.followup}}</Tag>
            </Col>

            <Col style="text-align: right;padding-right: 10px;">
              <a @click="routerse2(n.id,index)" href="javascript:;">编辑</a>
              <a v-if="cust08" @click="accesseeq(n.followup,n.id)" href="javascript:;">分配客户</a>
            </Col>


          </Row>

       </div>
        <Card class="cardlistno" style="min-height: 300px;text-align:center" v-if="datas.length ==0">
         <Icon type="sad-outline"></Icon>
          <p>没有数据</p>
        </Card>

       <div style="padding:10px 0 80px 0;background:#fff">
            <Page class="cf pages" :current="current" :total="totals" :page-size="pageSize"  @on-change="changepage" size="small"></Page>
          </div>
          <Spin size="large" fix v-if="loadings"></Spin>
      </div>
    <!-- rrrrrrr -->
    <Modal
          v-model="modalaccesseeq"
          title="分配客户"
          class="modalact"
          :styles="{top: '5px'}">
          <!-- kehu -->
          <Transfer
            :data="data3"
            :target-keys="targetKeys3"
            :list-style="listStyle"
            :render-format="render3"
            :operations="['取消','分配']"
            :titles="['人员','合作人']"
            filterable
            @on-change="handleChange3">
        </Transfer>
        <Alert type="warning" show-icon closable style="margin: 10px 0 0 0;">选择人员后点击 “取消分配客户”或“分配客户”</Alert>
          <!-- kehu -->
              <div slot="footer">
                  <!-- <Button type="primary" @click="Modalok">确定</Button> -->
                  <!-- <Button type="dashed" @click="Modalno">取消</Button> -->
              </div>
       </Modal>
    <!-- nav -->
   </div>
</template>

<script>
import axios from 'axios'
import Cookies from 'js-cookie';

export default {
    name: 'client',
      data () {
          return {
            ovhide:false,
            onst:-1,
            yeson:-1,
            yeson2:-1,
            yeson3:-1,
            yeson4:-1,
            childrenre:[],
            totals: 50, //总页数
            pageSize: 20, //每页显示
            current:1,
            indextbody:-1,
            loadings:true,
            screense:true,//条件
            cust08:false,//分配客户
            modalaccesseeq:false,//分配客户
            modalaccesseeqid:'',//分配客户id
            data3: [],
            targetKeys3: [],
            listStyle: {
                    width: '34%',
                    height: '300px'
                },
            options2: {
                    shortcuts: [
                        {
                            text: '一周',
                            value () {
                                const end = new Date();
                                const start = new Date();
                                start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);
                                return [start, end];
                            }
                        },
                        {
                            text: '一个月',
                            value () {
                                const end = new Date();
                                const start = new Date();
                                start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);
                                return [start, end];
                            }
                        },
                        {
                            text: '三个月',
                            value () {
                                const end = new Date();
                                const start = new Date();
                                start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);
                                return [start, end];
                            }
                        }
                    ]
                },
                followupdata: [{
                    value: '错误',
                    label: '错误'
                }],
                Cascaderdata: [
                {
                    value: '网络',
                    label: '网络',
                    children: [
                        {
                            value: '越办越好',
                            label: '越办越好'
                        },
                        {
                            value: '搜房',
                            label: '搜房'
                        },
                        {
                            value: '安居客',
                            label: '安居客'
                        },
                        {
                            value: '58同城',
                            label: '58同城'
                        }, 
                        {
                            value: '自定义',
                            label: '自定义'
                        },  
                    ]
                },
                {
                    value: '扫楼',
                    label: '扫楼',
                    children:[{
                      value: '扫楼',
                      label: '扫楼',
                    }]
                }, 
                {
                    value: '开发',
                    label: '开发',
                    children: [
                        {
                            value: '企业名录',
                            label: '企业名录'
                        },
                        {
                            value: '业主跟进',
                            label: '业主跟进'
                        },
                        {
                            value: '企查查/天眼查',
                            label: '企查查/天眼查'
                        },
                        {
                            value: '驻守',
                            label: '驻守'
                        },
                        {
                            value: '自定义',
                            label: '自定义'
                        },

                    ]
                }, 
                 {
                    value: '来访',
                    label: '来访',
                    children: [
                        {
                            value: '上门来访',
                            label: '上门来访'
                        },
                        {
                            value: '自定义',
                            label: '自定义'
                        },
                    ]
                }, 
                {
                    value: '介绍',
                    label: '介绍',
                    children: [
                        {
                            value: '朋友介绍显示',
                            label: '朋友介绍显示'
                        },
                        {
                            value: '朋友介绍隐藏',
                            label: '朋友介绍隐藏'
                        },
                    ]
                 }
                ],
              screens:{
                 name:'', //客户姓名
                 contact:'', //联系方式
                 status:'有效', //客户状态
                 gname:'', //客户公司
                 tradex:'', //客户行业
                 minaji:{
                  min:'',
                  max:''
                 }, //需求面积
                 minar:{
                  min:'',
                  max:''
                 }, //需求价格
                 grade:'',//客户等级
                 originalAddress:'',//原地址
                 timese:[], //时间
                 timese2:[], //时间
                 followup:[], //部门
                 id:'',
                 single: false, //我的合作
                 sorting:'0', //排序
                 luru:[], //录入
                 jieshao:'', //客户介绍人
                 cascader:[], //来源
              },
              datas:[
              // {
              //     id:12, //id
              //     uptime1:'2017-06-08 17:00:00', //最新跟进
              //     uptime2:'2017-06-08 17:00:00', //录入时间
              //     grade:'A', //客户等级
              //     originalAddress:'上海', //原地址
              //     cascader:'来源', //来源
              //     luru:'录入人', //录入人
              //     gname:'上海智哦熙信息技术有限公司', //客户公司
              //     name:["dasd",'asda'], //客户公司
              //     minaji:'1-5', //面积
              //     minar:'1-5', //面积
              //     intention:[{
              //       area:'浦东新区',
              //       subrange:'八佰伴',
              //       property:'江苏大厦',
              //       house:'14F-A1',
              //     }], //意向
              //     status:'状态', //客户状态
              //     followup:'跟进人', //跟进人
              // }
              ]
          }
        },
        mounted(){
           this.adminname(); //人员
           this.accesse(); //权限

           let _this = this;
               axios({
                method:'post',
                url:'/api/adminname',
                headers:{Authorization:'Bearer '+Cookies.set('keya')},
             })
            .then(function (res) {
              let data = res.data.message;
              // _this.metrosda = data;
              let metros = [];
                for (var i in data) {
                    let nea = {
                       key: data[i],
                       label: data[i],
                       description: data[i],
                      }
                  metros.push(nea)
               }
               _this.data3 = metros;
            })
            .catch(function (err) {
                _this.$Notice.error({title: '人员错误'});
            })

            // this.showHide(1); //table
            if (Cookies.getJSON('screense3') ==0 || Cookies.getJSON('screense3') == undefined ) {
                 this.showHide(1); //类表
             }else{
               let se = Cookies.getJSON('screense3')
               let page = Cookies.getJSON('page3')
               console.log(page)
               this.screens = se
               if (page == undefined) {
                 this.current = 1
                 this.showHidese(1)
               }else{
                 this.current = page
                 this.showHidese(page); //类表
               }
             }

             if (Cookies.set('params2') == undefined) {
                this.indextbody = -1
             }else{
                this.indextbody = Number(Cookies.set('params2'))
             }

        },
        methods:{
          navsr(e){
            this.onst = e
          },
          sorens(e){
            this.onst = -1;
            this.screens.sorting = String(e)
            Cookies.set('screense3', this.screens); //权限
            this.showHidese(1);
          },
          clickyes(e,a){
            // console.log(e)
            
            this.yeson = e;
            this.yeson2 = -1
            this.childrenre = this.followupdata[e].children
            if (a == "全选") {
              this.onst = -1;
              this.screens.followup[0] = "全选"
              this.screens.followup[1] = ''
              this.showHidese(1);
            }else{
              this.screens.followup[0] = a
              this.screens.followup[1] = ''
            }
          },
          clickyes2(e,a){
            this.yeson2 = e;
            this.screens.followup[1] = a
            this.onst = -1
            this.showHidese(1)
          },
          conyes(){
            this.onst = -1
            this.showHidese(1)
          },
          conno(){
            this.onst = -1
            this.screens.followup = []
            this.showHidese(1)
          },
          strenc(e){
            this.onst = -1;
            this.screens.status = e;
            this.showHidese(1)
          },
           accesse(){
             let _this = this;
             axios({
                method: 'post',
                url: '/api/power',
                headers: { Authorization: 'Bearer ' + Cookies.set('keya') },
              })
              .then(function(res) {
                  Cookies.set('auth', res.data.power); //权限
                  _this.cust08 = res.data.power.cust08
              })
              .catch(function(err) {
                  _this.$Notice.error({ title: '权限获取错误' });
              })
         },
         accesseeq(e,b){
            let data = e.split(',')
            this.targetKeys3 = data
            this.modalaccesseeqid = b
            this.modalaccesseeq = true
            console.log(e,b)
         },
         Modalok(){
            let _this = this;
            _this.modalaccesseeq = false
         },
         Modalno(){
            let _this = this;
            _this.modalaccesseeq = false
         },
         addLOUPan(){
            this.$router.push({
               name: 'client_add'
            });
         },
         adminname(){
           let _this = this;
            axios({
                method:'post',
                url:'/api/adminname2',
                headers:{Authorization:'Bearer '+Cookies.set('keya')},
             })
            .then(function (res) {
              if (res.data.statusx == 200) {
               _this.followupdata = res.data.message;
               for (var i = 0; i < _this.followupdata.length; i++) {
                
                 if (_this.followupdata[i].value !=="全选" && _this.followupdata[i].value !=="1部") {
                      _this.followupdata[i].children.push({
                        value: '公共账号',
                        label: '公共账号'
                      })
                 }
                    
                 }
                 
               _this.followupdata = res.data.message;
              }else{
                _this.$Notice.error({title: '人员错误'});
              }
            })
            .catch(function (err) {
                _this.$Notice.error({title: '人员错误'});
            })
         },
         showHide(e){
              var _this = this;
              _this.loadings = false;
              //房源默认没有条件
                 axios({
                  method:'post',
                  url:'/api/cluelist?page='+e,
                  headers:{Authorization:'Bearer '+Cookies.set('keya')},
               })
              .then(function (res) {
                _this.loadings = false;
                // console.log(res.data.message.data)
                _this.datas = res.data.message.data; //列表数据
                _this.pageSize = res.data.message.pageSize; //每页显示
                _this.totals = res.data.message.totals; //总数
              })
              .catch(function (err) {
                  _this.$Notice.error({title: '客户类表错误'});
              })
            },
            showHidese(e){
              var _this = this;
               _this.loadings = false;
              //   //房源有条件
                _this.loadings = true;
                 axios({
                  method:'post',
                  url:'/api/cluelist?page='+e,
                  headers:{Authorization:'Bearer '+Cookies.set('keya')},
                   data:{
                    jo:_this.screens
                  }
               })
              .then(function (res) {
               _this.loadings = false;
                // console.log(res.data.message.data)
                _this.datas = res.data.message.data; //列表数据
                _this.pageSize = res.data.message.pageSize; //每页显示
                _this.totals = res.data.message.totals; //总数
              })
               .catch(function (err) {
                  _this.$Notice.error({title: '客户类表错误'});
               })
            },
         changepage(page) {
          this.indextbody = -1
          Cookies.remove('params2')
          Cookies.set('screense3', this.screens); //权限
          var ele = document.getElementById('singlepagecon');
              ele.scrollTop = 0;
              
              //翻页
              var _this = this;
              _this.loadings = true;
              Cookies.set('page3', page); //权限
              if(_this.screense){
                _this.showHidese(page);
              }else{
                _this.showHide(page);
              }
            },
            soose(){
              Cookies.set('screense3', this.screens); //权限
              this.showHidese(1)
            },
            screenss(){
              this.onst = -1;
              let _this = this;
               _this.screense = true; //有搜索条件
               _this.loadings = true;
               Cookies.set('screense3', _this.screens); //权限
               //搜索
               _this.showHidese(1);
                // Cookies.set('screenss', true);
                // Cookies.set('screens', _this.screens);
            },
            reson(){
              this.onst = -1;
              //重置
              let _this = this;
              _this.screense = false; //无搜索条件
              // _this.showHide(1);
              Cookies.set('screense3', 0); //权限
              _this.screens ={
                 name:'', //客户姓名
                 contact:'', //联系方式
                 status:'有效', //客户状态
                 gname:'', //客户公司
                 tradex:'', //客户行业
                 minaji:{
                  min:'',
                  max:''
                 }, //需求面积
                 minar:{
                  min:'',
                  max:''
                 }, //需求价格
                 grade:'',//客户等级
                 originalAddress:'',//原地址
                 timese:[], //时间
                 timese2:[], //时间
                 followup:[], //部门
                 id:'',
                 single: false, //我的合作
                 sorting:'0', //排序
                 luru:[], //录入
                 jieshao:'', //客户介绍人
                 cascader:[], //来源
              }
              _this.showHidese(1);
            },
            routerse1(e,a){
              Cookies.set('params2', a,{ expires: 0.1 })
              let query = { deal_id: e};
                this.$router.push({
                 name: 'clientadd_look',
                 query: query
                });
            },
            routerse2(e,a){
              Cookies.set('params2', a,{ expires: 0.1 })
              let query = { deal_id: e};
                this.$router.push({
                 name: 'clientadd_edit',
                 query: query
                });
            },
            handleChange3 (newTargetKeys) {
                this.targetKeys3 = newTargetKeys;
                // console.log(newTargetKeys)
                let _this = this;
                    axios({
                      method:'post',
                      url:'/api/assign?id='+_this.modalaccesseeqid,
                      headers:{Authorization:'Bearer '+Cookies.set('keya')},
                      data:{jo:newTargetKeys}
                   })
                    .then(function (res){
                        if (res.data.statusx == 200){
                          _this.$Message.success('分配成功');
                           if(_this.screense){
                              _this.showHidese(1);
                            }else{
                              _this.showHide(1);
                            }
                            _this.modalaccesseeq = false
                        }else if(res.data.statusx == 202){
                          _this.$Notice.error({title: res.data.message});
                        }
                    })
                    .catch(function (err){
                        _this.$Notice.error({title: '分配失败'});
                    })

            },
            render3(item) {
                return item.label;
            }

        },
        watch: {
          onst: {
              handler: function(val, oldVal) {
                 if (val !== -1) {
                   this.ovhide = true
                 }else{
                   this.ovhide = false
                 }
              },
              deep: true
          },
      }
};
</script>

